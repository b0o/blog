---
import { useTranslate, getLanguageFromUrl, localizeUrl } from '@utils/i18n'
import { isActiveMenuItem, getMainMenuItems } from '@utils/menu'
import ThemeSelect from './ThemeSelect.astro'

const t = useTranslate(Astro)

const language = getLanguageFromUrl(Astro.url.pathname)
const mainMenuItems = getMainMenuItems(language)
---

<div
  class="flex h-full w-full items-center justify-between bg-background pr-horizontal-padding"
>
  <div class="mx-auto flex h-full w-full max-w-content justify-between">
    <nav
      class="flex h-full justify-between overflow-x-auto px-horizontal-padding"
      aria-label={t('MainNavigation')}
    >
      <ul class="m-0 flex list-none flex-row flex-nowrap items-center gap-2">
        {
          mainMenuItems.map((item) => {
            const isActive = isActiveMenuItem({
              currentPathname: Astro.url.pathname,
              menuItemPathname: item.pathname,
              rootPathname: localizeUrl('/', language),
            })

            return (
              <li>
                <a
                  id={item.identifier}
                  href={new URL(item.pathname, Astro.url)}
                  class:list={[
                    isActive
                      ? 'bg-primary text-on-primary card hover:bg-primary-hover'
                      : 'hover:bg-hover',
                    'relative flex items-center justify-center rounded border-0 py-1 px-2 transition-colors duration-300',
                  ]}
                  {...(isActive && { 'aria-current': 'page' })}
                >
                  {t(item.name)}
                </a>
              </li>
            )
          })
        }
      </ul>
    </nav>

    <div class="h-full py-3">
      <div class="flex h-full flex-row items-stretch gap-2 pl-2">
        <ThemeSelect />
      </div>
    </div>
  </div>
</div>
