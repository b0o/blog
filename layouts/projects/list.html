{{ define "main" }}
  <section class="">
    <ul class="list-none m-0">
    {{ range .Pages }}
      <li class="mb-16 last:mb-0">
        {{ $isUnmaintained := isset .Params "unmaintained" }}

        <article class="flex gap-4 flex-col sm:flex-row">
          <div class="relative rounded-0 sm:rounded-md -mx-default-padding sm:mx-0 overflow-hidden h-[216px] sm:w-2/5 border-y-2 sm:border-2 {{ if $isUnmaintained }}border-warn{{ else }}border-divider{{ end }}">
            {{ with (index (.Resources.ByType "image") 0) }}
              <img class="object-cover object-left-top min-w-full h-full" src="{{ .Permalink }}" width="auto" height="216" alt="">
              </img>
            {{ end }}

            {{ if $isUnmaintained }}
              <div class="absolute top-2 right-2 rounded-md bg-warn text-background dark:text-foreground px-2 py-1">
                Unmaintained
              </div>
            {{ end }}
          </div>

          <div class="flex-1 sm:flex sm:flex-col sm:justify-between">
            <div>
              <div class="flex items-center justify-between text-xl mb-4">
                <h2 class="m-0 inline-block">
                  <a
                    class="border-0 flex items-center gap-2"
                    {{ if .Params.website }}href="{{ .Params.website }}"{{ end }}
                  >
                    {{ .Title }}

                    {{ if .Params.website }}
                      {{ partial "svgs/external-link.svg" }}
                    {{ end }}
                  </a>
                </h2>

                <time class="font-bold" datetime="{{ .Date.Format "2006-01-02" }}">
                  {{ .Date.Format "2006" }}
                </time>
              </div>

              {{ .Content }}
            </div>

            <div class="mt-4 flex flex-nowrap gap-2 justify-between">
              <div class="flex items-center gap-2 overflow-x-auto">
                <img
                  class="h-10"
                  src="https://skillicons.dev/icons?i={{ delimit .Params.icons "," }}&theme=light"
                  alt="{{ i18n "Tech" }}: {{ delimit .Params.icons ", " (printf " %s " (i18n "And")) }}"
                >
                </img>
              </div>

              {{ with .Params.github }}
                <a
                  class="btn btn-primary btn-icon border-0"
                  style="--icon-size: 1.5em"
                  href="{{ . }}"
                >
                  {{ partial "svgs/github.svg" }}
                </a>
              {{ end }}
            </div>
          </div>
        </article>
      </li>
    {{ end }}
    </ul>
  </section>
{{ end }}

{{ define "scripts" }}
  <script>
    document.body.addEventListener('newTheme', function (e) {
      document.querySelectorAll('img[src*=skillicons]').forEach(function (img) {
        const url = new URL(img.getAttribute('src'))
        url.searchParams.set('theme', e.detail.theme)
        img.setAttribute('src', url)
      })
    })
  </script>
{{ end }}
