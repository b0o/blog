<!DOCTYPE html>
<html class="h-full" lang="{{ .Site.Params.htmlLang | default .Lang }}">
  <head>
    {{ partial "head.html" . }}

    {{ block "head" . }}
    {{ end }}

    {{ block "css" . }}
      {{ range (.Resources.Match "*.css") }}
        <link href="{{ .RelPermalink }}" rel="stylesheet" />
      {{ end }}
    {{ end }}
  </head>

  <body data-preload class="text-foreground bg-secondary-background transition-colors duration-500 ease-out">
    {{ block "script-elements" . }}
    {{ end }}

    {{ $themeScript := resources.Get "js/theme.js" }}

    {{ if hugo.IsProduction }}
      {{ $themeScript = $themeScript | minify }}
    {{ end }}

    <script>{{ $themeScript.Content | safeJS }}</script>

    <div data-scroll-container>
      {{ partial "nav.html" . }}

      <div class="max-w-5xl mx-auto w-full px-default-padding mt-20 py-4">
        <main class="bg-background w-full rounded-md shadow-md shadow-divider py-16 sm:px-16 px-default-padding">
          {{ block "main" . }}
            {{ .Content }}
          {{ end }}
        </main>
      </div>

      {{ partial "footer.html" . }}
    </div>

    {{ range (.Resources.Match "*.js") }}
      <script type="module" src="{{ .RelPermalink }}"></script>
    {{ end }}

    {{ $themeButtonScript := resources.Get "js/theme-button.js" | js.Build }}
    {{ $languageButtonScript := resources.Get "js/language-button.js" | js.Build }}
    {{ $navScript := resources.Get "js/nav.js" | js.Build }}
    {{ $copyCodeButtonScript := resources.Get "js/copy-code-button.js"
      | js.Build (dict "params" (dict "clipboardIcon" (partial "svgs/clipboard.svg") "copyCodeButtonLabel" (i18n "CopyCodeButtonLabel")))
    }}

    {{ $bundle := slice $navScript $themeButtonScript $languageButtonScript $copyCodeButtonScript | resources.Concat "js/bundle.js" }}

    {{ if hugo.IsProduction }}
      {{ $bundle = $bundle | minify }}
    {{ end }}

    <script type="module" src="{{ $bundle.Permalink }}"></script>

    {{ block "scripts" . }}
    {{ end }}
  </body>
</html>
