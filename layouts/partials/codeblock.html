{{ $devicon := partial "partials/devicon.html" . }}

{{ $hasDevicon := ne $devicon.Icon "" }}
{{ $hasFilename := false }}
{{ with .Attributes.filename }}
  {{ $hasFilename = true }}
{{ end }}
{{ $hasHeader := or $hasDevicon $hasFilename }}


<div
  data-codeblock
  class="{{ if $hasHeader }}
    mt-16
  {{ else }}
    mt-8
  {{ end }} group relative -mx-horizontal-padding mb-8 sm:mx-0 [&_pre]:shadow [&_pre]:shadow-shadow"
>
  {{ if $hasHeader }}
    <div
      class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden"
    >
      <div class="chroma flex items-center gap-2 rounded-t px-2 py-1">
        <div class="shrink-0">
          {{ if $hasDevicon }}
            <div class="h-[24px] w-[24px] [&>svg_*]:fill-current">
              {{ $devicon.Icon }}
            </div>
          {{ else }}
            {{ partial "svgs/file-text.svg" . }}
          {{ end }}
        </div>

        {{ with .Attributes.filename }}
          <div class="rtl truncate text-right">
            <bdi>
              {{- . -}}
            </bdi>
          </div>
        {{ else }}
          <div>
            {{ $devicon.Type | title }}
          </div>
        {{ end }}
      </div>
    </div>
  {{ end }}

  {{ highlight .Inner .Type .Options }}


  <button
    data-copy-code-button
    class="{{ if .Type }}
      dark
    {{ end }} btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100"
    aria-label="{{ i18n "CopyCodeButtonLabel" }}"
  >
    {{ partial "svgs/clipboard.svg" }}
  </button>
</div>
