{{ $sourceCode := (trim .Inner "\n\r") }}
{{ $appRootId := md5 $sourceCode }}


<div class="my-8">
  <div role="tablist" aria-label="Tabs" class="flex gap-1">
    <button
      role="tab"
      id="tab-{{ $appRootId }}-source"
      aria-selected="true"
      aria-controls="tabpanel-{{ $appRootId }}-source"
    >
      Source
    </button>

    <button
      role="tab"
      id="tab-{{ $appRootId }}-app"
      aria-selected="false"
      aria-controls="tabpanel-{{ $appRootId }}-app"
    >
      App
    </button>
  </div>

  <div
    role="tabpanel"
    id="tabpanel-{{ $appRootId }}-source"
    aria-labelledby="tab-{{ $appRootId }}-source"
  >
    {{ highlight $sourceCode "jsx" (.Get 0 | default "") }}
  </div>

  <div
    role="tabpanel"
    id="tabpanel-{{ $appRootId }}-app"
    aria-labelledby="tab-{{ $appRootId }}-app"
  >
    <div id="{{ $appRootId }}"></div>
  </div>
</div>

{{ $path := printf "js/react-widget-%s.js" $appRootId }}
{{ $context := dict "SourceCode" $sourceCode "AppRootId" $appRootId }}

{{ $shims := dict "react" "js/react.js" "react-dom" "js/react-dom.js" }}
{{ $builtJs := resources.Get "js/react-widget.jsx" | resources.ExecuteAsTemplate $path $context | js.Build (dict "externals" (slice "react" "react-dom") "format" "esm" "shims" $shims) }}


<script defer type="module" src="{{ $builtJs.Permalink }}"></script>
