{{ $sourceCode := (trim .Inner "\n\r") }}
{{ $appRootId := md5 $sourceCode }}


<div class="card my-8 p-page-padding">
  <div>
    {{ highlight $sourceCode "jsx" (.Get 0 | default "") }}
  </div>

  <div class="rounded-md border-2 border-divider bg-[white] p-8">
    <div id="{{ $appRootId }}"></div>
  </div>
</div>

{{ $path := printf "js/react-widget-%s.js" $appRootId }}
{{ $context := dict "SourceCode" $sourceCode "AppRootId" $appRootId }}

{{ $shims := dict "react" "js/shims/react.js" "react-dom" "js/shims/react-dom.js" }}
{{ $builtJs :=
  resources.Get "js/templates/react-widget.jsx"
  | resources.ExecuteAsTemplate $path $context
  | js.Build (dict "externals" (slice "react" "react-dom") "format" "esm" "shims" $shims)
}}


<script defer type="module" src="{{ $builtJs.Permalink }}"></script>
