{{ define "description" }}
  {{ .Summary }}
{{ end }}

{{ define "main" }}
  <main class="grid grid-cols-layout">
    <div
      class="card col-full max-w-full rounded-none py-16 px-page-padding shadow-none sm:col-content sm:rounded-md sm:px-16 sm:shadow-md"
    >
      <article>
        <header>
          <h1 class="mb-4 text-4xl">
            {{ .Title }}
          </h1>

          <div class="mb-4 flex flex-col gap-2">
            {{ partial "post-reading-time.html" . }}

            {{ partial "post-date.html" . }}
          </div>

          <div class="mb-4 flex flex-wrap gap-2">
            {{ range (.GetTerms "tags") }}
              <a href="{{ .RelPermalink }}" class="tag whitespace-nowrap">
                {{- .Title -}}
              </a>
            {{ end }}

            {{ partial "all-tags-button.html" . }}
          </div>
        </header>

        <hr class="my-8" />

        <div class="flex flex-col-reverse lg:flex-row">
          <div data-blog-post class="min-w-0 max-w-prose">
            {{ .Content }}
          </div>

          <aside
            class="w-full overflow-y-auto lg:sticky lg:top-0 lg:max-h-screen lg:pb-8 lg:pl-8"
          >
            {{ partial "toc.html" . }}
          </aside>
        </div>
      </article>

      <div
        data-theme-copy-code-tooltip
        role="tooltip"
        class="pointer-events-none absolute rounded-md border border-divider bg-background px-2"
        style="opacity: 0"
      >
        {{ i18n "Copied" }}


        <div
          data-theme-copy-code-tooltip-arrow
          class="absolute h-[8px] w-[8px] rotate-45 border-r border-b border-divider bg-background"
        ></div>
      </div>

      {{ if hugo.IsProduction }}
        <hr class="my-8" />

        <script
          src="https://utteranc.es/client.js"
          repo="phelipetls/phelipetls.github.io"
          issue-term="pathname"
          theme="preferred-color-scheme"
          crossorigin="anonymous"
          async
        ></script>
      {{ end }}


      <hr class="my-8" />

      {{ partial "post-nav.html" . }}
    </div>
  </main>
{{ end }}

{{ define "head" }}
  {{ $darkSyntaxHighlight := resources.Get "css/dark-syntax-highlight.css" }}
  {{ $liteYoutubeEmbedCss := resources.Get "/css/lite-yt-embed.css" | postCSS }}

  {{ if hugo.IsProduction }}
    {{ $darkSyntaxHighlight = $darkSyntaxHighlight | minify }}
    {{ $liteYoutubeEmbedCss = $liteYoutubeEmbedCss | minify }}
  {{ end }}


  <link rel="stylesheet" href="{{ $liteYoutubeEmbedCss.Permalink }}" />
  <link rel="stylesheet" href="{{ $darkSyntaxHighlight.RelPermalink }}" />
{{ end }}

{{ define "scripts" }}
  {{ $liteYoutubeEmbedJs := resources.Get "/js/lite-yt-embed.js" | js.Build }}
  {{ $themeUtterancesJs := resources.Get "/js/theme-utterances.js" }}
  {{ $tabsJs := resources.Get "/js/tabs.js" }}
  {{ $tocJs := resources.Get "/js/toc.js" }}
  {{ $copyCodeButtonScript :=
    resources.Get "js/copy-code-button.js"
    | js.Build (dict "params" (dict "clipboardIcon" (partial "svgs/clipboard.svg") "copyCodeButtonLabel" (i18n "CopyCodeButtonLabel")))
  }}

  {{ $bundle := slice $liteYoutubeEmbedJs $themeUtterancesJs $tabsJs $tocJs $copyCodeButtonScript | resources.Concat "js/post-bundle.js" }}

  {{ if hugo.IsProduction }}
    {{ $bundle = $bundle | minify }}
  {{ end }}


  <script src="{{ $bundle.Permalink }}"></script>

  {{ if .Params.react }}
    {{ $reactBundle := resources.Get "/js/react-bundle.js" | js.Build }}

    {{ if hugo.IsProduction }}
      {{ $reactBundle := $reactBundle | minify }}
    {{ end }}


    <script src="{{ $reactBundle.Permalink }}"></script>
  {{ end }}
{{ end }}
